<!DOCTYPE html>
<html>

  <head>
    <meta charset='utf-8' />
    <meta http-equiv="X-UA-Compatible" content="chrome=1" />
    <meta name="description" content="Tuco tuco : Yet another South American rodent...a Capybara like web app testing tool for Elixir." />

    <link rel="stylesheet" type="text/css" media="screen" href="stylesheets/stylesheet.css">

    <title>Tuco tuco</title>
  </head>

  <body>

    <!-- HEADER -->
    <div id="header_wrap" class="outer">
        <header class="inner">
          <a id="forkme_banner" href="https://github.com/stuart/tuco_tuco">View on GitHub</a>

          <h1 id="project_title">Tuco tuco</h1>
          <h2 id="project_tagline">Yet another South American rodent...a Capybara like web app testing tool for Elixir.</h2>

            <section id="downloads">
              <a class="zip_download_link" href="https://github.com/stuart/tuco_tuco/zipball/master">Download this project as a .zip file</a>
              <a class="tar_download_link" href="https://github.com/stuart/tuco_tuco/tarball/master">Download this project as a tar.gz file</a>
            </section>
        </header>
    </div>

    <!-- MAIN CONTENT -->
    <div id="main_content_wrap" class="outer">
      <section id="main_content" class="inner">
        <h1>
<a name="tucotuco" class="anchor" href="#tucotuco"><span class="octicon octicon-link"></span></a>TucoTuco</h1>

<p><a href="https://travis-ci.org/stuart/tuco_tuco"><img src="https://travis-ci.org/stuart/tuco_tuco.png?branch=master" alt="Build Status"></a></p>

<p>Testing for Elixir web applications.</p>

<p>TucoTuco helps you test your web application by running a web browser
and simulating user interaction with your application.</p>

<p>With a DSL approximating that of Capybara's, it should be
easy for developers to write tests for a web application.</p>

<h2>
<a name="setup" class="anchor" href="#setup"><span class="octicon octicon-link"></span></a>Setup</h2>

<p>In your mix.exs add the following to the test environment deps:</p>

<p><code>{:tucotuco, github: "stuart/tuco_tuco"}</code></p>

<p>Either specify tuco_tuco in your application block in mix.exs or do:</p>

<p><code>:application.start TucoTuco</code></p>

<h2>
<a name="requirements" class="anchor" href="#requirements"><span class="octicon octicon-link"></span></a>Requirements</h2>

<p>Testing requires that you have Phantomjs, Firefox or ChromeDriver installed.
You can also test against a remote WebDriver server such as a Selenium instance.</p>

<h2>
<a name="documentation" class="anchor" href="#documentation"><span class="octicon octicon-link"></span></a>Documentation</h2>

<p>Here is a rough guide to using TucoTuco.</p>

<h3>
<a name="navigation" class="anchor" href="#navigation"><span class="octicon octicon-link"></span></a>Navigation</h3>

<p>Visit sends the browser to other pages.</p>

<div class="highlight highlight-elixir"><pre>    <span class="n">visit</span> <span class="s2">"http://elixir-lang.org"</span>
    <span class="n">visit</span> <span class="s2">"/login"</span>
</pre></div>

<p>Relative urls will be appended with the TucoTuco.app_root value.</p>

<p>You can go back and forward in the browser history:</p>

<div class="highlight highlight-elixir"><pre>    <span class="n">go_forward</span>
    <span class="n">go_back</span>
</pre></div>

<p>And query the current url:</p>

<div class="highlight highlight-elixir"><pre>    <span class="n">current_url</span>
    <span class="n">current_path</span>
    <span class="n">current_query</span>
    <span class="n">current_port</span>
</pre></div>

<h3>
<a name="clicking" class="anchor" href="#clicking"><span class="octicon octicon-link"></span></a>Clicking</h3>

<p>You can click on a link or button with the <code>click_link</code> and
  <code>click_button</code> commands.</p>

<div class="highlight highlight-elixir"><pre>    <span class="n">click_link</span> <span class="s2">"Home"</span>
    <span class="n">click_link</span> <span class="s2">"i3"</span>
    <span class="n">click_button</span> <span class="s2">"Back"</span>
    <span class="n">click_button</span> <span class="s2">"Submit"</span>
</pre></div>

<p>Yet to come: mouse movements.</p>

<h3>
<a name="forms" class="anchor" href="#forms"><span class="octicon octicon-link"></span></a>Forms</h3>

<p>Interacting with forms is easy with TucoTuco's functions for that:</p>

<div class="highlight highlight-elixir"><pre>    <span class="n">fill_in</span> <span class="s2">"Login"</span><span class="p">,</span> <span class="s2">"Stuart"</span>
    <span class="n">fill_in</span> <span class="s2">"Password"</span><span class="p">,</span> <span class="s2">"secret_password"</span>
    <span class="n">click_button</span> <span class="s2">"Submit"</span>
    <span class="n">choose</span> <span class="s2">"A radio button"</span>
    <span class="n">select</span> <span class="s2">"Carrot"</span>
    <span class="n">select</span> <span class="s2">"Tomato"</span><span class="p">,</span> <span class="ss">from:</span> <span class="s2">"Vegetables"</span>
    <span class="n">check</span> <span class="s2">"A Checkbox"</span>
</pre></div>

<p>You can even attach files:</p>

<div class="highlight highlight-elixir"><pre>    <span class="n">attach_file</span> <span class="s2">"Upload Picture"</span><span class="p">,</span> <span class="s2">"path/to/my_photo.png"</span>
</pre></div>

<h3>
<a name="querying" class="anchor" href="#querying"><span class="octicon octicon-link"></span></a>Querying</h3>

<p>Getting information about the page to use in assertions:</p>

<div class="highlight highlight-elixir"><pre>    <span class="no">Page</span><span class="o">.</span><span class="n">has_css?</span> <span class="s2">"table thead tr.header"</span>
    <span class="no">Page</span><span class="o">.</span><span class="n">has_xpath?</span> <span class="s2">"//foo/bar[@name='baz']"</span>
    <span class="no">Page</span><span class="o">.</span><span class="n">has_text?</span> <span class="s2">"Some text from the page"</span>
    <span class="no">Page</span><span class="o">.</span><span class="n">has_link?</span> <span class="s2">"Back"</span>
</pre></div>

<p>There are many more. Check the documentation for them.</p>

<h3>
<a name="assertions" class="anchor" href="#assertions"><span class="octicon octicon-link"></span></a>Assertions</h3>

<p>TucoTuco supplies two assertions that you can use directly in tests:</p>

<div class="highlight highlight-elixir"><pre>    <span class="n">assert_selector</span> <span class="ss">:xpath</span><span class="p">,</span> <span class="s2">"//foo/bar"</span>
    <span class="n">refute_selector</span> <span class="ss">:xpath</span><span class="p">,</span> <span class="s2">"//baz[@class='bob']"</span>
</pre></div>

<h3>
<a name="elements" class="anchor" href="#elements"><span class="octicon octicon-link"></span></a>Elements</h3>

<p>The following functions for manipulating elements are imported from
  WebDriver, they all take a WebDriver.Element.Reference record as the
  first argument. Luckily that is exactly what all the finders return:</p>

<div class="highlight highlight-elixir"><pre>    <span class="no">Element</span><span class="o">.</span><span class="n">attribute</span> <span class="n">reference</span><span class="p">,</span> <span class="ss">:a_html_attribute</span>
    <span class="no">Element</span><span class="o">.</span><span class="n">clear</span> <span class="n">reference</span>
    <span class="no">Element</span><span class="o">.</span><span class="n">click</span> <span class="n">reference</span>
    <span class="no">Element</span><span class="o">.</span><span class="n">css</span> <span class="n">reference</span><span class="p">,</span> <span class="s2">"some-css-property-name"</span>
    <span class="no">Element</span><span class="o">.</span><span class="n">displayed?</span> <span class="n">reference</span>
    <span class="no">Element</span><span class="o">.</span><span class="n">enabled?</span> <span class="n">reference</span>
    <span class="no">Element</span><span class="o">.</span><span class="n">equals?</span> <span class="n">reference</span><span class="p">,</span> <span class="n">other_reference</span>
    <span class="no">Element</span><span class="o">.</span><span class="n">location?</span> <span class="n">reference</span>
    <span class="no">Element</span><span class="o">.</span><span class="n">location_in_view?</span> <span class="n">reference</span>
    <span class="no">Element</span><span class="o">.</span><span class="n">name</span> <span class="n">reference</span>
    <span class="no">Element</span><span class="o">.</span><span class="n">selected?</span> <span class="n">reference</span>
    <span class="no">Element</span><span class="o">.</span><span class="n">size</span> <span class="n">reference</span>
    <span class="no">Element</span><span class="o">.</span><span class="n">submit</span> <span class="n">reference</span>
    <span class="no">Element</span><span class="o">.</span><span class="n">text</span> <span class="n">reference</span>
    <span class="no">Element</span><span class="o">.</span><span class="n">value</span> <span class="n">reference</span><span class="p">,</span> <span class="s2">"value to set"</span>
</pre></div>

<p>For more detailed docs on the Element functions see
  <a href="http://stuart.github.io/elixir-webdriver/WebDriver.Element.html">WebDriver.Element</a>.</p>

<h3>
<a name="javascript" class="anchor" href="#javascript"><span class="octicon octicon-link"></span></a>Javascript</h3>

<p>Javascript can be run using the <code>execute_javascript</code> and <code>execute_async_javascript</code>
  commands.</p>

<div class="highlight highlight-elixir"><pre>    <span class="n">iex</span><span class="o">&gt;</span> <span class="n">execute_javascript</span> <span class="s2">"return argument[0] * 10"</span><span class="p">,</span> <span class="p">[</span><span class="m">3</span><span class="p">]</span>
    <span class="n">iex</span><span class="o">&gt;</span> <span class="m">30</span>
</pre></div>

<h3>
<a name="retrying" class="anchor" href="#retrying"><span class="octicon octicon-link"></span></a>Retrying</h3>

<p>When you are testing applications that have Javascript modifying the page
  it is possible that elements will not be available when you want them because
  the browser script takes some time to run.</p>

<p>To alleviate this TucoTuco has retry settings. When retry is turned on all the
  Page.has_foo? and action functions will retry for a set number of times before failing.</p>

<p>You can also use the retry function yourself like this:</p>

<div class="highlight highlight-elixir"><pre>    <span class="c1"># Find elements</span>
    <span class="no">TucoTuco</span><span class="o">.</span><span class="no">Finder</span><span class="o">.</span><span class="n">find</span> <span class="n">using</span><span class="p">,</span> <span class="n">selector</span>

    <span class="c1"># Any function</span>
    <span class="no">TucoTuco</span><span class="o">.</span><span class="no">Retry</span><span class="o">.</span><span class="n">retry</span> <span class="k">fn</span> <span class="o">-&gt;</span> <span class="n">my_function</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="k">end</span>
</pre></div>

<p>Changing retry settings:</p>

<div class="highlight highlight-elixir"><pre>    <span class="c1"># Set retries on</span>
    <span class="no">TucoTuco</span><span class="o">.</span><span class="n">use_retries</span> <span class="no">true</span>
    <span class="c1"># Set the maximum retry time in milliseconds.</span>
    <span class="no">TucoTuco</span><span class="o">.</span><span class="n">max_retry_time</span> <span class="m">1000</span>
    <span class="c1"># Set the delay between retries in milliseconds.</span>
    <span class="no">TucoTuco</span><span class="o">.</span><span class="n">retry_delay</span> <span class="m">20</span>
</pre></div>

<h3>
<a name="multiple-sessions" class="anchor" href="#multiple-sessions"><span class="octicon octicon-link"></span></a>Multiple Sessions</h3>

<p>You can run multiple sessions on different browser or on the same browser.
  To start a session use:</p>

<pre><code>    TucoTuco.start_session :browser_name, :session_name, browser_type
</code></pre>

<p>Where the browser type is one of :phantomjs, :firefox or :chrome.
  If the process :browser_name is already running the session will be started on
  that, otherwise a new browser will start running.</p>

<p>Once you have multiple sessions running you can swap sessions with:</p>

<pre><code>    TucoTuco.session :new_session
</code></pre>

<p>And to get a list of sessions that are running:</p>

<pre><code>    TucoTuco.sessions
</code></pre>

<p>Example Session from console:
( some responses have been cut for brevity )</p>

<div class="highlight highlight-elixir"><pre>  <span class="n">iex</span><span class="p">(</span><span class="m">1</span><span class="p">)</span><span class="o">&gt;</span> <span class="kn">use</span> <span class="no">TucoTuco</span><span class="o">.</span><span class="no">DSL</span>
  <span class="ss">:ok</span>
  <span class="n">iex</span><span class="p">(</span><span class="m">2</span><span class="p">)</span><span class="o">&gt;</span> <span class="no">TucoTuco</span><span class="o">.</span><span class="n">start_session</span> <span class="ss">:test_browser</span><span class="p">,</span> <span class="ss">:tuco_test</span><span class="p">,</span> <span class="ss">:phantomjs</span>
  <span class="p">{</span><span class="ss">:ok</span><span class="p">,</span>
   <span class="no">TucoTuco</span><span class="o">.</span><span class="no">SessionPool</span><span class="o">.</span><span class="no">SessionPoolState</span><span class="p">[</span><span class="ss">current_session:</span> <span class="ss">:tuco_test</span><span class="p">,</span>
    <span class="ss">app_root:</span> <span class="no">nil</span><span class="p">]}</span>
  <span class="n">iex</span><span class="p">(</span><span class="m">3</span><span class="p">)</span><span class="o">&gt;</span> <span class="n">visit</span> <span class="s2">"http://elixir-lang.org"</span>
  <span class="n">iex</span><span class="p">(</span><span class="m">4</span><span class="p">)</span><span class="o">&gt;</span> <span class="n">current_url</span>
  <span class="s2">"http://elixir-lang.org/"</span>
  <span class="n">iex</span><span class="p">(</span><span class="m">5</span><span class="p">)</span><span class="o">&gt;</span> <span class="n">click_link</span> <span class="s2">"getting started guide"</span>
  <span class="n">iex</span><span class="p">(</span><span class="m">6</span><span class="p">)</span><span class="o">&gt;</span> <span class="n">current_url</span>
  <span class="s2">"http://elixir-lang.org/getting_started/1.html"</span>
  <span class="n">iex</span><span class="p">(</span><span class="m">7</span><span class="p">)</span><span class="o">&gt;</span> <span class="no">Page</span><span class="o">.</span><span class="n">has_css?</span> <span class="s2">"article h1</span><span class="err">#</span><span class="s2">toc_0"</span>
  <span class="no">true</span>
  <span class="n">iex</span><span class="p">(</span><span class="m">8</span><span class="p">)</span><span class="o">&gt;</span> <span class="no">Page</span><span class="o">.</span><span class="n">has_text?</span> <span class="s2">"Elixir also supports UTF-8 encoded strings:"</span>
  <span class="no">true</span>
  <span class="n">iex</span><span class="p">(</span><span class="m">9</span><span class="p">)</span><span class="o">&gt;</span> <span class="n">click_link</span> <span class="s2">"Next →"</span>
  <span class="n">iex</span><span class="p">(</span><span class="m">10</span><span class="p">)</span><span class="o">&gt;</span> <span class="n">current_url</span>
  <span class="s2">"http://elixir-lang.org/getting_started/2.html"</span>
  <span class="n">iex</span><span class="p">(</span><span class="m">11</span><span class="p">)</span><span class="o">&gt;</span> <span class="no">Page</span><span class="o">.</span><span class="n">has_xpath?</span> <span class="s2">"//h1[.='2 Diving in']"</span>
  <span class="no">true</span>
  <span class="n">iex</span><span class="p">(</span><span class="m">15</span><span class="p">)</span><span class="o">&gt;</span> <span class="n">go_back</span>
  <span class="n">iex</span><span class="p">(</span><span class="m">16</span><span class="p">)</span><span class="o">&gt;</span> <span class="n">current_path</span>
  <span class="s2">"/getting_started/1.html"</span>
  <span class="n">iex</span><span class="p">(</span><span class="m">17</span><span class="p">)</span><span class="o">&gt;</span>
</pre></div>

<h3>
<a name="changelog" class="anchor" href="#changelog"><span class="octicon octicon-link"></span></a>Changelog</h3>

<p>2014-03-02</p>

<ul>
<li>0.2.1</li>
<li>Element functions from WebDriver</li>
<li>Retries</li>
</ul><p>2014-03-04</p>

<ul>
<li>0.3.0</li>
<li>Added execute_javascript and execute_async_javascript</li>
</ul>
      </section>
    </div>

    <!-- FOOTER  -->
    <div id="footer_wrap" class="outer">
      <footer class="inner">
        <p class="copyright">Tuco tuco maintained by <a href="https://github.com/stuart">stuart</a></p>
        <p>Published with <a href="http://pages.github.com">GitHub Pages</a></p>
      </footer>
    </div>

    

  </body>
</html>
